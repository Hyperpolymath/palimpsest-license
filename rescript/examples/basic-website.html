<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basic Palimpsest Integration Example</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            max-width: 800px;
            margin: 2rem auto;
            padding: 0 1rem;
            line-height: 1.6;
        }
        h1 { color: #663399; }
        #palimpsest-badge { margin: 1rem 0; }
        #metadata-display { margin: 2rem 0; }
        .error { color: #f44336; padding: 1rem; background: #ffebee; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>My Creative Work</h1>

    <article>
        <h2>Echoes of Resilience</h2>
        <p>
            This is a creative work exploring themes of cultural identity and personal growth.
            It is protected under the Palimpsest License to ensure proper attribution and
            consent management for AI usage.
        </p>
    </article>

    <!-- License Badge -->
    <div id="palimpsest-badge"></div>

    <!-- Metadata Display -->
    <div id="metadata-display"></div>

    <!-- Compliance Status -->
    <div id="compliance-status"></div>

    <!-- Metadata in JSON-LD format -->
    <script type="application/ld+json" id="palimpsest-metadata">
    {
        "version": "0.4",
        "language": "en",
        "workTitle": "Echoes of Resilience",
        "workIdentifier": "urn:isbn:978-0-00-000000-0",
        "licenseUri": "https://palimpsest.org/licenses/v0.4",
        "attribution": {
            "creators": [
                {
                    "name": "Jane Doe",
                    "identifier": "https://orcid.org/0000-0000-0000-0000",
                    "role": "Author"
                }
            ],
            "dateCreated": "2025-01-15",
            "mustPreserveLineage": true
        },
        "consents": [
            {
                "usageType": "interpretive",
                "status": "conditional:Non-commercial research only",
                "grantedDate": "2025-01-15",
                "revocable": true
            },
            {
                "usageType": "training",
                "status": "denied",
                "revocable": true
            },
            {
                "usageType": "personal",
                "status": "granted",
                "revocable": false
            }
        ],
        "emotionalLineage": {
            "origin": "Personal experiences of diaspora",
            "culturalContext": "Exploring themes of identity and belonging in a multicultural society",
            "traumaMarker": false,
            "narrativeIntent": "To share stories of resilience and hope"
        }
    }
    </script>

    <!--
        NOTE: In a real implementation, update these import paths to point to your
        compiled ReScript JavaScript files. For example:

        import { parseString } from '../lib/js/src/core/MetadataParser.bs.js';

        This example uses placeholder paths for demonstration.
    -->
    <script type="module">
        // PLACEHOLDER: Update these paths to your actual compiled files
        // import { parseString } from '../lib/js/src/core/MetadataParser.bs.js';
        // import { generateVersionBadge } from '../lib/js/src/components/BadgeGenerator.bs.js';
        // import { display } from '../lib/js/src/components/MetadataDisplay.bs.js';
        // import { check } from '../lib/js/src/core/ComplianceChecker.bs.js';

        // For demonstration, we'll show the structure
        console.log('Palimpsest License Integration Example');
        console.log('To use this example:');
        console.log('1. Build the ReScript project: npm run build');
        console.log('2. Update the import paths above');
        console.log('3. Open this file in a web browser');

        // Example implementation (uncomment after building):
        /*
        const scriptEl = document.getElementById('palimpsest-metadata');
        const result = parseString(scriptEl.textContent);

        if (result.TAG === 'Ok') {
            const metadata = result._0;

            // Generate and display badge
            const badge = generateVersionBadge(metadata);
            document.getElementById('palimpsest-badge').innerHTML = badge;

            // Display metadata
            const style = {
                format: { TAG: 2 }, // Detailed
                showIcons: true,
                showLinks: true,
                highlightTrauma: true
            };
            const metadataHtml = display(metadata, { style });
            document.getElementById('metadata-display').innerHTML = metadataHtml;

            // Check compliance for interpretive AI use
            const usageType = { TAG: 0 }; // Interpretive
            const complianceResult = check(metadata, [usageType]);

            if (!complianceResult.isCompliant) {
                const statusHtml = `
                    <div class="error">
                        <h3>⚠️ Usage Restrictions</h3>
                        <p>This work has restrictions on AI interpretive use.</p>
                    </div>
                `;
                document.getElementById('compliance-status').innerHTML = statusHtml;
            }
        } else {
            console.error('Error parsing metadata:', result._0);
        }
        */
    </script>
</body>
</html>
